<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/style.css">
<title>管理者ページ</title>
</head>
<body>

<script>
if (!sessionStorage.getItem("admin")) {
  const p = prompt("管理者パスワード");
  if (p !== "admin123") location.href = "index.html";
  sessionStorage.setItem("admin", "1");
}
</script>

<div class="container">
  <h1>管理者ページ</h1>

  <p>現在の参加者数：<strong id="count">取得中…</strong> 人</p>

  <input id="pass" type="password" placeholder="CSVダウンロード用パスワード">
  <button onclick="download()">CSVダウンロード</button>
</div>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbxIYRkLcINKdPJ_HkNM22RUJvxnA6UzJDY0_jKVOhPStr6X_sGlHaIPDaFQ-5V80KDxKA/exec";

// 人数取得
fetch(GAS_URL + "?count=1")
  .then(r => r.text())
  .then(n => document.getElementById("count").textContent = n);

function download() {
  window.location =
    GAS_URL + "?pass=" + encodeURIComponent(pass.value);
}
</script>

</body>
</html>
